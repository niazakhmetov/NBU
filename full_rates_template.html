<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ L.nav_full_rates_title }} | TengeHub</title>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        .calculator-row {
            /* Переопределяем стили для формы в строгом виде */
            display: grid;
            grid-template-columns: 1fr 1fr 200px; /* Две даты и кнопка */
            gap: 20px;
            align-items: end;
        }
        .form-group input[type="date"], .form-group select {
            /* Унаследовать стиль из main.css или использовать базовый */
            padding: 8px;
            border: 1px solid var(--color-border);
            border-radius: 4px;
            width: 100%;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    
    {# =================================================================
       1. ШАПКА И НАВИГАЦИЯ (Использование классов .navbar и .logo)
       ================================================================= #}
    <header>
        <div class="container navbar">
            <div class="logo">TengeHub</div> 
            
            <nav>
                <a href="index.html">{{ L.nav_main }}</a>
                {# Устанавливаем активный класс для текущей страницы #}
                <a href="full_rates.html" class="active">{{ L.nav_all_rates }}</a>
                <a href="about.html">{{ L.nav_about }}</a>
                <a href="status.html">{{ L.nav_status | default('Статус') }}</a> 
            </nav>
        </div>
    </header>

    {# =================================================================
       2. ОСНОВНОЙ КОНТЕНТ (Использование класса .container)
       ================================================================= #}
    <div class="container">

        <h1>
            {{ L.nav_full_rates_title }}
            <span style="color: var(--color-brand-primary);">({{ course_date }})</span>
        </h1>
        <p style="margin-bottom: 25px;">
            {{ L.full_list_description | default('Полный перечень официальных курсов валют Национального Банка Республики Казахстан.') }}
        </p>

        {# =================================================================
           3. БЛОК РАСЧЕТА КУРСОВЫХ РАЗНИЦ (Использование класса .card)
           ================================================================= #}
        <section class="card">
            <h3>{{ L.calculator_h2 }} (Развивается)</h3>
            <p style="color: var(--color-text-secondary);">
                Инструмент для оперативного расчета курсовых разниц между двумя выбранными датами.
            </p>
            
            <div class="calculator-row" style="margin-top: 20px;">
                <div class="form-group">
                    <label for="date1">{{ L.calculator_date1 }}</label>
                    <input type="date" id="date1" value="{{ course_date }}" class="input-field"> 
                </div>
                
                <div class="form-group">
                    <label for="date2">{{ L.calculator_date2 }}</label>
                    <input type="date" id="date2" value="{{ course_date }}" class="input-field">
                </div>

                <div class="form-group">
                    {# Использование классов .btn из main.css #}
                    <button class="theme-toggle" id="calculate-btn" disabled style="width: 100%;">
                        {{ L.calculator_btn }}
                    </button>
                </div>
            </div>
            
            <div id="calculation-result" style="margin-top: 15px; font-weight: bold; color: var(--color-status-down);">
            </div>
        </section>

        {# =================================================================
           4. БЛОК ЭКСПОРТА ДАННЫХ (Использование класса .card)
           ================================================================= #}
        <section class="card">
            <h3>{{ L.export_h2 }}</h3>
            <p style="color: var(--color-text-secondary);">
                Выберите период или дату для выгрузки официального курса в формате, удобном для бухгалтерии и аудита.
            </p>
            
            <div class="export-options" style="display: flex; gap: 20px; align-items: end; margin-top: 20px;">
                <div class="form-group" style="flex-grow: 1;">
                    <label for="export-start-date">Начальная дата</label>
                    <input type="date" id="export-start-date" value="{{ course_date }}" class="input-field"> 
                </div>
                
                <div class="form-group" style="flex-grow: 1;">
                    <label for="export-end-date">Конечная дата</label>
                    <input type="date" id="export-end-date" value="{{ course_date }}" class="input-field">
                </div>
                
                <div style="flex-shrink: 0; display: flex; gap: 10px;">
                    {# Используем стили кнопок из main.css #}
                    <button class="theme-toggle" id="export-csv-btn" disabled>
                        {{ L.export_btn_csv }}
                    </button>
                    <button class="theme-toggle" id="print-btn" disabled>
                        {{ L.export_btn_print }}
                    </button>
                </div>
            </div>
        </section>

        {# =================================================================
           5. ТАБЛИЦА ПОЛНОГО СПИСКА КУРСОВ (Использование .data-table)
           ================================================================= #}
        <section class="card full-rates-table">
            <h2 style="margin-bottom: 20px;">{{ L.table_full_rates_h2 }}</h2>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th style="width: 8%;">Код</th>
                        <th style="width: 35%;">{{ L.CURRENCY_NAME }}</th>
                        <th style="width: 15%; text-align: right;">{{ L.quant_header | default('Кратность') }}</th>
                        <th style="width: 27%; text-align: right;">{{ L.RATE_NAME }} (за KZT)</th>
                        <th style="width: 15%; text-align: right;">{{ L.CHANGE }}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for rate in rates %}
                    <tr>
                        <td>{{ rate.code }}</td>
                        <td>{{ rate.full_name }}</td>
                        <td style="text-align: right;">{{ rate.quant }}</td>
                        <td style="text-align: right; font-weight: 500;">
                            {{ "%.4f" | format(rate.course) }}
                        </td> 
                        {# Использование классов .change-up/.change-down из main.css #}
                        <td class="{% if rate.change > 0 %}change-up{% elif rate.change < 0 %}change-down{% else %}change-neutral{% endif %}" style="text-align: right;">
                            {% if rate.change > 0 %}+{% endif %}
                            {{ "%.4f" | format(rate.change) }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>

    </div>
    
{# =================================================================
       6. НИЖНИЙ ФУТЕР (Минималистичный шаблон)
       ================================================================= #}
    <footer>
        <div class="container footer-minimal-content">
            <p class="footer-source-text">
                &copy; {{ now().strftime('%Y') | default('2025') }} TengeHub. 
                <span class="source-info">{{ L.footer_data_source | default('Данные получены с официального SOAP-сервиса Национального Банка РК.') }}</span>
            </p>
        </div>
    </footer>
    
    {# Сохранение существующего JS-функционала #}
    <script>
        document.getElementById('calculate-btn').addEventListener('click', function() {
            alert('Функционал расчета курсовых разниц будет реализован с использованием JavaScript для запроса исторических данных. Сейчас этот функционал отключен.');
        });
        document.getElementById('export-csv-btn').addEventListener('click', function() {
            alert('Функционал экспорта требует JS-логики для сбора и форматирования данных. Сейчас этот функционал отключен.');
        });
        document.getElementById('print-btn').addEventListener('click', function() {
            alert('Функционал печати данных. Сейчас этот функционал отключен.');
        });
    </script>
</body>
</html>
