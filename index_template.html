<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ L.title_main | default('–û–±–º–µ–Ω–Ω—ã–µ –∫—É—Ä—Å—ã') }} | TengeHub</title>
    
    {# ‚≠ê –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –µ–¥–∏–Ω–æ–≥–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–∏–ª—è #}
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    
    {# =================================================================
       1. –®–ê–ü–ö–ê, –ù–ê–í–ò–ì–ê–¶–ò–Ø –ò –ö–û–ù–¢–†–û–õ–´
       ================================================================= #}
    <header>
        <div class="container navbar">
            <div class="logo">TengeHub</div> 
            
            {# ‚≠ê –ù–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏: –ì–ª–∞–≤–Ω–∞—è, –í—Å–µ –∫—É—Ä—Å—ã, –°—Ç–∞—Ç—É—Å, –û –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ #}
            <nav>
                <a href="index.html" class="active">{{ L.nav_main | default('–ì–ª–∞–≤–Ω–∞—è') }}</a>
                <a href="full_rates.html">{{ L.nav_all_rates | default('–í—Å–µ –∫—É—Ä—Å—ã') }}</a>
                <a href="status.html">{{ L.nav_status | default('–°—Ç–∞—Ç—É—Å') }}</a>
                <a href="about.html">{{ L.nav_about | default('–û –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ') }}</a>
            </nav>
            
            {# ‚≠ê –ì—Ä—É–ø–ø–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–∑—ã–∫–∞ –∏ —Ç–µ–º—ã #}
            <div class="controls-group">
                <div id="language-switcher">
                    <button class="theme-toggle" onclick="setLang('ru')" data-lang="ru">RU</button>
                    <button class="theme-toggle" onclick="setLang('kz')" data-lang="kz">KZ</button>
                    <button class="theme-toggle" onclick="setLang('en')" data-lang="en">EN</button>
                </div>
                {# –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã: –∏–∫–æ–Ω–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS #}
                <button class="theme-toggle" onclick="toggleTheme()" id="theme-toggle-btn">
                    ‚òÄÔ∏è
                </button>
            </div>
        </div>
    </header>
    
    {# =================================================================
       2. –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢
       ================================================================= #}
    <main class="container">
        
        <h1 style="margin-bottom: 25px;">
            {{ L.title_main | default('–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ë–∞–Ω–∫–∞ –†–ö') }}
        </h1>

        {# --- ‚≠ê –ù–û–í–´–ô –ë–õ–û–ö: –ö–†–ê–¢–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –°–ò–°–¢–ï–ú–ï (–ù–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–°—Ç–∞—Ç—É—Å") --- #}
        <section class="card" style="margin-top: 20px; padding: 15px 30px; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; border-left: 5px solid var(--color-brand-primary);">
            <div style="margin-right: 20px; margin-bottom: 10px;">
                <span style="font-weight: 600; color: var(--color-text-primary);">
                    {{ L.status_sync | default('–°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:') }}
                </span>
                <span id="api-status" 
                      class="{% if api_status == '–£–°–ü–ï–®–ù–û' %}change-up{% else %}change-down{% endif %}"
                      style="font-size: 1.1em; margin-left: 5px;">
                    {{ api_status | default('–ü—Ä–æ–≤–µ—Ä–∫–∞...') }}
                </span>
            </div>
            <div style="margin-bottom: 10px;">
                <span style="font-weight: 600; color: var(--color-text-primary);">
                    {{ L.status_last_update_time | default('–í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:') }}
                </span>
                <span id="update-time" style="color: var(--color-brand-secondary); margin-left: 5px;">
                    {{ update_time | default('N/A') }}
                </span>
            </div>
        </section>

        {# --- –ë–õ–û–ö –° –î–ê–¢–û–ô –ê–ö–¢–£–ê–õ–¨–ù–û–°–¢–ò –ö–£–†–°–û–í --- #}
        <section class="card" style="margin-top: 20px;">
            <p style="color: var(--color-text-secondary);">
                {{ L.date_info | default('–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ë–∞–Ω–∫–∞ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞:') }}
            </p>
            <h2 style="font-size: 1.8em; margin-top: 5px; color: var(--color-text-primary);">
                {{ course_date | default('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö') }}
            </h2>
            <p style="margin-top: 15px;">
                <a href="full_rates.html" style="font-weight: 600;">
                    {{ L.cta_all_rates | default('–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ 52 –∫—É—Ä—Å–∞ ‚Üí') }}
                </a>
            </p>
        </section>

        {# --- –¢–ê–ë–õ–ò–¶–ê 10 –û–°–ù–û–í–ù–´–• –í–ê–õ–Æ–¢ --- #}
        <section class="card" style="padding: 0; margin-top: 30px;">
            <table class="data-table">
                <thead>
                    <tr>
                        <th style="width: 55%;">{{ L.table_currency | default('–í–∞–ª—é—Ç–∞') }}</th>
                        <th style="width: 15%; text-align: center;">{{ L.table_rate | default('–ö—É—Ä—Å (KZT)') }}</th>
                        <th style="width: 15%; text-align: center;">{{ L.table_quant | default('–ï–¥–∏–Ω–∏—Ü–∞') }}</th>
                        <th style="width: 15%; text-align: right;">{{ L.table_change | default('–ò–∑–º–µ–Ω–µ–Ω–∏–µ') }}</th>
                    </tr>
                </thead>
                <tbody>
                    {# ‚≠ê –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –ø–µ—Ä–≤—ã–º 10 —ç–ª–µ–º–µ–Ω—Ç–∞–º —Å–ø–∏—Å–∫–∞ key_rates #}
                    {% for item in key_rates[:10] %}
                    <tr>
                        <td data-label="{{ L.table_currency | default('–í–∞–ª—é—Ç–∞') }}">{{ item.fullname | default('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ') }} ({{ item.title }})</td>
                        <td data-label="{{ L.table_rate | default('–ö—É—Ä—Å (KZT)') }}" style="text-align: center;">{{ item.description }}</td>
                        <td data-label="{{ L.table_quant | default('–ï–¥–∏–Ω–∏—Ü–∞') }}" style="text-align: center; color: var(--color-text-secondary);">{{ item.quant }}</td>
                        
                        {# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ styles/main.css #}
                        <td data-label="{{ L.table_change | default('–ò–∑–º–µ–Ω–µ–Ω–∏–µ') }}" 
                            class="{% if item.index == 'UP' %}change-up{% elif item.index == 'DOWN' %}change-down{% else %}change-neutral{% endif %}"
                            style="text-align: right;">
                            {{ item.change | default('0.00') }}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>

    </main>
    
    {# =================================================================
       3. –ü–û–î–í–ê–õ (–ù–æ–≤—ã–π —Ç–µ–∫—Å—Ç –£–¢–ü)
       ================================================================= #}
    <footer>
        <div class="container">
            <p style="font-size: 0.9em; line-height: 1.4;">
                &copy; {{ now().strftime('%Y') | default('2025') }} TengeHub. –†–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è **–±—É—Ö–≥–∞–ª—Ç–µ—Ä–æ–≤ –∏ —ç–∫–æ–Ω–æ–º–∏—Å—Ç–æ–≤** –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –∏ —Ç–æ—á–Ω—ã–º–∏ –∫—É—Ä—Å–∞–º–∏ –≤–∞–ª—é—Ç. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –∏–∑ **–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ë–∞–Ω–∫ –†–ö)**, —á—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏—Ö –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å –¥–ª—è —Ü–µ–ª–µ–π —É—á–µ—Ç–∞.
            </p>
        </div>
    </footer>

    {# =================================================================
       4. JS –î–õ–Ø –ú–£–õ–¨–¢–ò–Ø–ó–´–ß–ù–û–°–¢–ò –ò –¢–ï–ú–´
       ================================================================= #}
    <script>
        // --- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞: –ü–ï–†–ï–ó–ê–ì–†–£–ñ–ê–ï–¢ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –Ω–æ–≤—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º lang (–ò–°–ü–†–ê–í–õ–ï–ù–û) ---
        function setLang(lang) {
            const url = new URL(window.location.href);
            url.searchParams.set('lang', lang);
            window.location.href = url.toString();
        }
        
        // --- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã ---
        function toggleTheme() {
            const body = document.body;
            const btn = document.getElementById('theme-toggle-btn');
            
            body.classList.toggle('dark-theme');
            
            const isDark = body.classList.contains('dark-theme');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            
            btn.textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
        }

        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ---
        window.onload = () => {
            const currentLang = '{{ L.language_code | default("ru") }}';
            
            // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–∑—ã–∫–∞: –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('#language-switcher button').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-lang') === currentLang) {
                    btn.classList.add('active'); 
                }
            });

            // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã
            const savedTheme = localStorage.getItem('theme');
            const btn = document.getElementById('theme-toggle-btn');
            
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-theme');
                btn.textContent = 'üåô';
            } else {
                document.body.classList.remove('dark-theme');
                btn.textContent = '‚òÄÔ∏è';
            }
        };
    </script>
</body>
</html>
